{% extends "parametres.html" %}

{% block parametres_content %}
  <h2>Paramètres de génération de plan-cadre</h2>

  <p>
    Les tags principaux que vous avez déjà identifiés dans les sections sont :
  </p>
  <ul>
    <li>{code_cours}</li>
    <li>{nom_cours}</li>
    <li>{fil_conducteur}</li>
    <li>{programme} (à définir selon vos besoins)</li>
    <li>{session}</li>
  </ul>

  <p>
    Sous-tags disponibles dans les compétences :
  </p>
  <ul>
    <li>{element_nom} : Le nom de l'élément de compétence.</li>
    <li>{element_competence_id} : L'ID de l'élément de compétence.</li>
    <li>{status} : Le statut de l'élément de compétence (par exemple, "Développé significativement").</li>
    <li>{competence_id} : L'ID de la compétence associée à l'élément de compétence.</li>
    <li>{critere_performance} : Le critère de performance associé à l'élément de compétence.</li>
    <li>{competence_nom} : Le nom de la compétence associée.</li>
    <li>{contexte_realisation} : Le contexte de réalisation de la compétence.</li>
  </ul>

  <form method="POST">
      {{ form.hidden_tag() }} <!-- Inclut le token CSRF -->

      <div class="card mb-4">
        <div class="card-header bg-light">
          <strong>Paramètres IA (section Plan‑cadre)</strong>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label">{{ ai_form.system_prompt.label }}</label>
            {{ ai_form.system_prompt(class_='form-control font-monospace', rows=8) }}
          </div>
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label">{{ ai_form.ai_model.label }}</label>
              {{ ai_form.ai_model(class_='form-select') }}
            </div>
            <div class="col-md-4">
              <label class="form-label">{{ ai_form.reasoning_effort.label }}</label>
              {{ ai_form.reasoning_effort(class_='form-select') }}
            </div>
            <div class="col-md-4">
              <label class="form-label">{{ ai_form.verbosity.label }}</label>
              {{ ai_form.verbosity(class_='form-select') }}
            </div>
          </div>
        </div>
      </div>
      
      <div class="table-responsive">
          <table class="table table-bordered">
              <thead>
                  <tr>
                      <th>Section</th>
                      <th>Texte / Prompt</th>
                  </tr>
              </thead>
              <tbody>
                  {% for section_form, section_name in sections_with_forms %}
                      <tr>
                          <td>{{ section_name }}</td>
                          <td>{{ section_form.text_content(class="form-control", rows=3, cols=60) }}</td>
                      </tr>
                  {% endfor %}
              </tbody>
          </table>
      </div>
      
      <button type="submit" class="btn btn-success">Sauvegarder les paramètres</button>
  </form>
{% endblock %}
